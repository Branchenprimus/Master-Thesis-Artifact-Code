LOG: Full prompt prepared:
You are an expert in structured query languages, specifically SPARQL, the query language for RDF databases.

Your task is to generate **only** valid SPARQL queries that precisely answer the user’s question by leveraging the provided shape constraints.

Rules:
1. **Use the given shape constraints to construct an optimal SPARQL query.** The shape provides the structure and relationships available in the dataset.
2. **Ensure the generated query adheres strictly to the provided shape.** Do not reference entities or properties that are not described in the shape.
3. **Respond only with a valid SPARQL query.** Do not include explanations, comments, or additional text.
4. **Do not generate natural language responses.** Return only raw SPARQL code.
5. **Ensure the query is syntactically correct.** Follow SPARQL standards strictly.
6. **Use standard prefixes (`PREFIX`) where necessary.** Optimize queries for performance.
7. **Do not provide comments (`#`) or descriptions.** The response must be executable as-is.

The user’s query and the dataset’s structural constraints (shape) are provided below. Your task is to generate the correct SPARQL query that best answers the user’s request.

---

User prompt:
How many ontologies are defined?

Shape:
@prefix : <http://weso.es/shapes/> .
@prefix pv: <http://ld.company.org/prod-vocab/> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix void: <http://rdfs.org/ns/void#> .
@prefix wgs84: <http://www.w3.org/2003/01/geo/wgs84_pos#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

:BillOfMaterial a sh:NodeShape ;
    sh:property [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdfs:label ],
        [ a sh:PropertyShape ;
            sh:in ( pv:BillOfMaterial ) ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdf:type ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:name ],
        [ a sh:PropertyShape ;
            sh:minCount 1 ;
            sh:node :BomPart ;
            sh:path pv:hasBomPart ] ;
    sh:targetClass pv:BillOfMaterial .

:Dataset a sh:NodeShape ;
    sh:property [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdfs:label ],
        [ a sh:PropertyShape ;
            sh:in ( void:Dataset ) ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdf:type ] ;
    sh:targetClass void:Dataset .

:Employee a sh:NodeShape ;
    sh:property [ a sh:PropertyShape ;
            sh:in ( pv:Employee ) ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdf:type ],
        [ a sh:PropertyShape ;
            sh:minCount 1 ;
            sh:node :ProductCategory ;
            sh:path pv:areaOfExpertise ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdfs:label ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:email ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:path pv:addressText ],
        [ a sh:PropertyShape ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:node :Manager ;
            sh:path pv:hasManager ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:path pv:phone ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:name ],
        [ a sh:PropertyShape ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:node :Department ;
            sh:path pv:memberOf ] ;
    sh:targetClass pv:Employee .

:Service a sh:NodeShape ;
    sh:property [ a sh:PropertyShape ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:node :Price ;
            sh:path pv:price ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:name ],
        [ a sh:PropertyShape ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:nodeKind sh:IRI ;
            sh:path pv:hasProductManager ],
        [ a sh:PropertyShape ;
            sh:minCount 1 ;
            sh:node :Hardware ;
            sh:path pv:eligibleFor ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdfs:label ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:id ],
        [ a sh:PropertyShape ;
            sh:in ( pv:Service ) ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdf:type ],
        [ a sh:PropertyShape ;
            sh:maxCount 1 ;
            sh:node :ProductCategory ;
            sh:path pv:hasCategory ] ;
    sh:targetClass pv:Service .

:BomPart a sh:NodeShape ;
    sh:property [ a sh:PropertyShape ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:node :Hardware ;
            sh:path pv:hasPart ],
        [ a sh:PropertyShape ;
            sh:in ( pv:BomPart ) ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdf:type ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:minCount 1 ;
            sh:path pv:quantity ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:minCount 1 ;
            sh:path rdfs:label ] ;
    sh:targetClass pv:BomPart .

:Manager a sh:NodeShape ;
    sh:property [ a sh:PropertyShape ;
            sh:in ( pv:Manager ) ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdf:type ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:email ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:name ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdfs:label ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:phone ],
        [ a sh:PropertyShape ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:node :Department ;
            sh:path pv:memberOf ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:path pv:addressText ] ;
    sh:targetClass pv:Manager .

:Supplier a sh:NodeShape ;
    sh:property [ a sh:PropertyShape ;
            sh:in ( pv:Supplier ) ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdf:type ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:path wgs84:long ],
        [ a sh:PropertyShape ;
            sh:maxCount 1 ;
            sh:nodeKind sh:IRI ;
            sh:path pv:country ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:addressCountry ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:path wgs84:lat ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:addressCountryCode ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:id ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdfs:label ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:addressLocality ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:name ] ;
    sh:targetClass pv:Supplier .

:Department a sh:NodeShape ;
    sh:property [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdfs:label ],
        [ a sh:PropertyShape ;
            sh:in ( pv:Department ) ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdf:type ],
        [ a sh:PropertyShape ;
            sh:minCount 1 ;
            sh:node :Hardware ;
            sh:path pv:responsibleFor ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:name ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:id ] ;
    sh:targetClass pv:Department .

:Price a sh:NodeShape ;
    sh:property [ a sh:PropertyShape ;
            sh:dataType xsd:decimal ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:amount ],
        [ a sh:PropertyShape ;
            sh:in ( pv:Price ) ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdf:type ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdfs:label ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:currency ] ;
    sh:targetClass pv:Price .

:ProductCategory a sh:NodeShape ;
    sh:property [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:name ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdfs:label ],
        [ a sh:PropertyShape ;
            sh:in ( pv:ProductCategory ) ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdf:type ] ;
    sh:targetClass pv:ProductCategory .

:Hardware a sh:NodeShape ;
    sh:property [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdfs:label ],
        [ a sh:PropertyShape ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:node :Supplier ;
            sh:path pv:hasSupplier ],
        [ a sh:PropertyShape ;
            sh:node :ProductCategory ;
            sh:path pv:hasCategory ],
        [ a sh:PropertyShape ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:nodeKind sh:IRI ;
            sh:path pv:hasProductManager ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:integer ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:height_mm ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:integer ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:depth_mm ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:id ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:integer ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:width_mm ],
        [ a sh:PropertyShape ;
            sh:node :Hardware ;
            sh:path pv:compatibleProduct ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:name ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:decimal ;
            sh:maxCount 1 ;
            sh:path pv:reliabilityIndex ],
        [ a sh:PropertyShape ;
            sh:in ( pv:Hardware ) ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path rdf:type ],
        [ a sh:PropertyShape ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:node :Price ;
            sh:path pv:price ],
        [ a sh:PropertyShape ;
            sh:dataType xsd:integer ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path pv:weight_g ] ;
    sh:targetClass pv:Hardware .
✅ Response saved to /p/project1/hai_kg-rag-thesis/scripts/KG_Agent_MK1/logs/13-02-2025/KG_Agent_MK1_10985898/misc/temp/llm_response.txt
